# Q_DLP 开发环境配置说明

## Python 虚拟环境

项目已配置使用根目录下的 `.venv` 虚拟环境，包含以下依赖：

### 已安装包
- **PyQt6** (6.9.0) - GUI 框架
- **yt-dlp** (2025.5.22) - 视频下载核心库
- **pyinstaller** (6.13.0) - 打包工具
- **pillow** (11.2.1) - 图像处理
- 其他依赖包...

## 运行程序

### 方法一：使用启动脚本（推荐）
```bash
# Windows
./run.bat

# Linux/macOS  
./run.sh
```

### 方法二：直接使用虚拟环境Python
```bash
# Windows
D:/proj/q_dlp/.venv/Scripts/python.exe src/main.py

# Linux/macOS
./.venv/bin/python src/main.py
```

### 方法三：激活虚拟环境后运行
```bash
# Windows
.venv\Scripts\activate
python src/main.py

# Linux/macOS
source .venv/bin/activate
python src/main.py
```

## 开发和测试

### 运行设置功能测试
```bash
# Windows
D:/proj/q_dlp/.venv/Scripts/python.exe test_settings.py

# Linux/macOS
./.venv/bin/python test_settings.py
```

### VS Code Python 解释器配置

在 VS Code 中：
1. 按 `Ctrl+Shift+P` 打开命令面板
2. 输入 "Python: Select Interpreter"
3. 选择项目根目录下的 `.venv/Scripts/python.exe` (Windows) 或 `.venv/bin/python` (Linux/macOS)

### 安装新依赖

如需安装新的 Python 包：
```bash
# Windows
D:/proj/q_dlp/.venv/Scripts/pip.exe install 包名

# Linux/macOS
./.venv/bin/pip install 包名
```

## 项目结构

```
q_dlp/
├── .venv/                 # Python虚拟环境
├── src/                   # 源代码
│   ├── main.py           # 程序入口
│   ├── MainWindow.py     # 主窗口（包含设置功能）
│   ├── dlp.py            # 下载核心
│   ├── utils.py          # 配置管理工具
│   ├── db.py             # 数据库操作
│   └── config.json       # 配置文件（自动生成）
├── config/                # 配置文件
├── icon/                  # 图标资源
├── scripts/               # 构建脚本
├── run.bat               # Windows启动脚本
├── run.sh                # Linux/macOS启动脚本
└── test_settings.py      # 设置功能测试
```

## 注意事项

- 确保始终使用虚拟环境中的 Python 解释器
- 配置文件 `config.json` 会在首次运行时自动创建
- 设置修改后立即生效，无需重启程序
- 虚拟环境已包含所有必需的依赖包

## 故障排除

### Python 解释器问题
如果程序无法启动，请检查：
1. 虚拟环境是否存在：`.venv/Scripts/python.exe` (Windows)
2. VS Code 是否选择了正确的 Python 解释器
3. 依赖包是否完整安装

### PyQt6 相关问题
如果出现 GUI 相关错误：
1. 确认 PyQt6 已正确安装
2. 检查系统是否支持 Qt6
3. 尝试重新安装 PyQt6：`pip install --force-reinstall PyQt6`

现在您的项目已完全配置为使用虚拟环境运行！