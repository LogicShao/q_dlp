# Q_DLP 详细使用教程

## 📋 目录
1. [快速入门](#快速入门)
2. [界面介绍](#界面介绍)
3. [基本操作](#基本操作)
4. [高级功能](#高级功能)
5. [故障排除](#故障排除)

## 🚀 快速入门

### 第一步：启动程序
```bash
# 激活虚拟环境（如果使用）
.venv\Scripts\activate

# 运行程序
python main.py
```

### 第二步：添加下载任务
1. 点击顶部工具栏的 **"添加"** 按钮
2. 在弹出的对话框中输入视频链接
3. 选择下载格式
4. 点击 **"立即下载"** 或 **"添加到队列"**

### 第三步：开始下载
- **立即下载**：添加后直接开始下载
- **队列下载**：添加到列表后，选中任务点击 **"开始"** 按钮

## 🖥️ 界面介绍

### 主窗口布局

```
┌─────────────────────────────────────────────┐
│  [添加] [开始] [暂停] │ [删除] [清空] [设置] [帮助] │ ← 工具栏
├─────────────────────────────────────────────┤
│ 下载路径: [C:\Users\...\download] [浏览...]      │ ← 路径选择
├─────────────────────────────────────────────┤
│                                           │
│           任务列表区域                        │ ← 下载队列
│                                           │
├─────────────────────────────────────────────┤
│ ████████████████████░░░░░░░  75%           │ ← 进度条
├─────────────────────────────────────────────┤
│ [开始下载] https://...                      │
│ [下载中] 12.3% | 速度: 800KB/s | 剩余: 00:01    │ ← 日志区域
│ [完成] 文件保存为: video.mp4                  │
└─────────────────────────────────────────────┘
```

### 工具栏功能

| 按钮 | 功能 | 快捷键 |
|------|------|--------|
| 添加 | 添加新的下载任务 | Ctrl+N |
| 开始 | 开始下载选中的任务 | F5 |
| 暂停 | 暂停当前下载（开发中） | F6 |
| 删除 | 删除选中的任务 | Delete |
| 清空 | 清空所有任务 | Ctrl+Del |
| 设置 | 打开设置窗口（开发中） | F10 |
| 帮助 | 显示帮助信息 | F1 |

## 📝 基本操作

### 添加下载任务

1. **点击添加按钮**
   - 工具栏点击"添加"
   - 弹出"添加下载任务"对话框

2. **输入视频信息**
   ```
   视频URL: https://www.bilibili.com/video/BV1xx411xxx
   下载格式: [最高质量 ▼]
   ```

3. **选择下载格式**
   - **最高质量**：自动选择可用的最高画质
   - **1080P**：1920×1080 分辨率
   - **720P**：1280×720 分辨率
   - **480P**：854×480 分辨率
   - **仅音频**：只下载音频，保存为 MP3

4. **执行下载**
   - **立即下载**：添加后立即开始下载
   - **添加到队列**：加入下载列表，稍后下载

### 管理下载任务

#### 选择任务
- **单选**：点击任务条目
- **多选**：Ctrl + 点击多个任务
- **全选**：Ctrl + A

#### 删除任务
1. 选中要删除的任务
2. 点击"删除"按钮或按 Delete 键
3. 确认删除操作

#### 清空队列
1. 点击"清空"按钮
2. 确认清空所有任务

### 下载进度监控

#### 进度条显示
- **绿色进度条**：显示当前下载百分比
- **文字提示**：显示具体进度数字

#### 日志信息
```
[开始下载] https://www.bilibili.com/video/BV1xx411xxx
[下载中] 25.6% | 速度: 1.2MB/s | 剩余: 00:02:15
[下载中] 50.2% | 速度: 1.1MB/s | 剩余: 00:01:45
[完成] 文件保存为: D:\download\视频标题.mp4
```

#### 状态栏信息
- **准备就绪**：等待下载任务
- **正在下载**：显示当前下载的 URL
- **下载完成**：任务完成提示
- **下载失败**：错误状态提示

## ⚙️ 高级功能

### 自定义下载路径

1. **方法一：浏览选择**
   - 点击"浏览..."按钮
   - 选择目标文件夹
   - 确认路径

2. **方法二：直接输入**
   - 在路径输入框中直接输入路径
   - 支持相对路径和绝对路径
   - 程序会自动创建不存在的目录

3. **路径示例**
   ```
   # 绝对路径
   D:\Videos\Downloads
   
   # 相对路径
   .\download\bilibili
   
   # 网络路径
   \\server\shared\videos
   ```

### 批量下载管理

#### 批量添加
1. 多次使用"添加"功能
2. 每个任务会显示在列表中
3. 可以为不同任务选择不同格式

#### 队列执行
1. 选中第一个任务，点击"开始"
2. 当前任务完成后，手动开始下一个
3. 支持下载过程中添加新任务

#### 任务优先级
- 手动控制下载顺序
- 通过拖拽调整任务位置（开发中）
- 优先下载选中的任务

### 下载记录管理

#### 历史记录
- 程序自动保存所有下载记录
- 重启后会恢复未完成的任务
- 支持查看历史下载状态

#### 数据库操作
```python
# 查看下载统计
from db import get_download_stats
stats = get_download_stats()
print(f"总计：{stats['total_count']} 个任务")
print(f"成功：{stats['finished_count']} 个")
print(f"成功率：{stats['success_rate']:.1f}%")

# 备份数据库
from db import backup_database
backup_database("backup.db")
```

## 🔧 故障排除

### 常见错误及解决方案

#### 1. 网络连接错误
**现象**：下载失败，提示网络错误
**解决**：
- 检查网络连接
- 尝试使用代理
- 稍后重试

#### 2. 权限错误
**现象**：无法创建下载目录
**解决**：
- 检查目录权限
- 选择有写权限的目录
- 以管理员身份运行

#### 3. 磁盘空间不足
**现象**：下载中断或失败
**解决**：
- 清理磁盘空间
- 选择其他磁盘保存
- 选择较低清晰度

#### 4. 视频不可用
**现象**：提示视频无法访问
**解决**：
- 检查链接是否正确
- 确认视频是否公开
- 检查地区限制

### 性能优化建议

#### 下载速度优化
1. **选择合适的清晰度**
   - 根据需要选择分辨率
   - 避免下载过高清晰度

2. **网络优化**
   - 关闭其他占用带宽的程序
   - 使用有线网络连接
   - 选择网络状况良好的时间

3. **系统优化**
   - 确保足够的内存和CPU资源
   - 关闭不必要的后台程序
   - 定期清理临时文件

#### 存储管理
1. **定期整理下载文件**
2. **备份重要的下载记录**
3. **清理不需要的任务记录**

## 📊 使用技巧

### 最佳实践

1. **URL 规范化**
   ```bash
   # 推荐使用完整链接
   https://www.bilibili.com/video/BV1xx411xxx
   
   # 避免使用短链接
   b23.tv/xxxxx
   ```

2. **格式选择建议**
   - 日常观看：720P 或 480P
   - 收藏保存：1080P 或最高质量
   - 音乐收听：仅音频
   - 移动设备：480P

3. **路径管理**
   ```
   # 按平台分类
   D:\Videos\Bilibili\
   D:\Videos\YouTube\
   
   # 按日期分类
   D:\Downloads\2025-09\
   D:\Downloads\2025-10\
   ```

### 键盘快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+N | 添加新任务 |
| F5 | 开始下载 |
| Delete | 删除选中任务 |
| Ctrl+A | 全选任务 |
| Ctrl+D | 取消全选 |
| F1 | 显示帮助 |
| Alt+F4 | 退出程序 |

### 自动化脚本

可以编写 Python 脚本实现自动化操作：

```python
# 批量添加下载任务
from db import insert_download

urls = [
    "https://www.bilibili.com/video/BV1xx411xxx",
    "https://www.youtube.com/watch?v=xxxxx",
]

for url in urls:
    insert_download(url, "", "", "auto")
    print(f"已添加：{url}")
```

---

## 📞 获取帮助

如果您在使用过程中遇到问题：

1. **查看本教程**：大多数常见问题都有解答
2. **查看 FAQ**：`docs/faq.md` 包含更多问题解答
3. **检查日志**：程序日志窗口会显示详细信息
4. **提交 Issue**：在 GitHub 上报告 Bug 或提出建议

---

*教程最后更新：2025年9月28日*