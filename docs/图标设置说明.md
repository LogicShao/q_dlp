# Q_DLP 应用程序图标设置说明

## 图标配置概述

Q_DLP 视频下载器现在使用统一的图标系统，所有窗口和对话框都正确设置了相应的图标，提供更专业的视觉体验。

## 图标文件结构

```
icon/
├── q_dlp.ico      # 主程序图标 (7646 字节)
├── settings.ico   # 设置对话框图标 (14910 字节)
└── run.ico        # 运行相关图标 (7289 字节)
```

## 图标使用分配

### 🖥️ 主窗口
- **文件**: `icon/q_dlp.ico`
- **用途**: 应用程序主界面图标
- **显示位置**: 
  - 窗口标题栏左侧
  - 任务栏图标
  - Alt+Tab切换时的图标

### ⚙️ 设置对话框
- **文件**: `icon/settings.ico`
- **用途**: 设置界面专用图标
- **显示位置**: 设置对话框标题栏
- **备用方案**: 如果文件不存在，使用系统主题图标

### ➕ 添加任务对话框  
- **文件**: `icon/q_dlp.ico`
- **用途**: 复用主程序图标保持一致性
- **显示位置**: 添加任务对话框标题栏

## 技术实现

### 1. 统一图标路径管理
```python
def get_icon_path(icon_name: str) -> str:
    """获取图标文件路径，兼容开发和打包环境"""
    if hasattr(sys, '_MEIPASS'):
        # 打包后的环境
        return os.path.join(sys._MEIPASS, 'icon', icon_name)
    else:
        # 开发环境
        project_root = os.path.dirname(os.path.dirname(__file__))
        return os.path.join(project_root, 'icon', icon_name)
```

### 2. 窗口图标设置
```python
# 主窗口
icon_path = get_icon_path('q_dlp.ico')
self.setWindowIcon(QIcon(icon_path))

# 设置对话框  
settings_icon_path = get_icon_path('settings.ico')
if os.path.exists(settings_icon_path):
    self.setWindowIcon(QIcon(settings_icon_path))
else:
    self.setWindowIcon(QIcon.fromTheme("preferences-system"))
```

### 3. 兼容性设计
- **开发环境**: 使用项目根目录的 `icon/` 文件夹
- **打包环境**: 使用PyInstaller打包后的资源路径
- **容错机制**: 图标文件不存在时使用系统默认图标

## 打包配置

### PyInstaller 图标设置
```bash
# 基本打包命令（包含图标）
pyinstaller --onefile --windowed --icon=icon/q_dlp.ico src/main.py

# 完整打包命令（包含资源文件）
pyinstaller --onefile --windowed \
    --icon=icon/q_dlp.ico \
    --add-data "icon;icon" \
    --add-data "config;config" \
    src/main.py
```

### spec文件配置
如果使用spec文件，确保包含图标资源：
```python
# Q_DLP.spec
a = Analysis(['src/main.py'],
             datas=[('icon', 'icon'), ('config', 'config')],
             ...)

exe = EXE(pyz,
          a.scripts,
          icon='icon/q_dlp.ico',  # 可执行文件图标
          ...)
```

## 图标文件规范

### 📏 尺寸要求
- **标准尺寸**: 16x16, 32x32, 48x48, 256x256 像素
- **推荐格式**: ICO格式（支持多尺寸）
- **颜色深度**: 32位真彩色（带透明度）

### 🎨 设计原则
- **简洁明了**: 在小尺寸下仍能清晰识别
- **品牌一致**: 与应用程序风格保持统一
- **高对比度**: 在浅色和深色背景下都清晰可见

### 📐 制作工具
- **专业工具**: Adobe Illustrator, Photoshop
- **免费工具**: GIMP, Inkscape
- **在线工具**: favicon.io, icon-icons.com

## 验证方法

### 1. 开发环境测试
```bash
# 运行图标测试脚本
python test_icons.py
```

### 2. 程序启动测试
```bash
# 启动主程序查看图标
python src/main.py
```

### 3. 功能测试清单
- [ ] 主窗口标题栏显示正确图标
- [ ] 任务栏显示正确图标  
- [ ] 设置对话框显示设置图标
- [ ] 添加任务对话框显示主程序图标
- [ ] Alt+Tab切换显示正确图标

## 故障排除

### 图标不显示
1. **检查文件存在**: 确认 `icon/q_dlp.ico` 文件存在
2. **检查文件格式**: 确认是有效的ICO文件
3. **检查路径**: 验证相对路径计算是否正确
4. **重启程序**: 图标缓存问题可能需要重启

### 打包后图标异常
1. **检查打包配置**: 确认 `--icon` 参数正确
2. **检查资源包含**: 确认icon文件夹被包含在打包中
3. **检查路径计算**: 验证 `get_icon_path()` 函数逻辑

### 系统兼容性
- **Windows**: 完全支持ICO格式
- **macOS**: 建议额外提供ICNS格式
- **Linux**: 支持ICO，也可使用PNG

## 扩展功能

### 1. 托盘图标
可以扩展支持系统托盘图标：
```python
from PyQt6.QtWidgets import QSystemTrayIcon

tray_icon = QSystemTrayIcon(QIcon(get_icon_path('q_dlp.ico')))
tray_icon.show()
```

### 2. 动态图标
可以根据程序状态切换图标：
```python
# 下载中使用不同图标
if self.is_downloading:
    icon_path = get_icon_path('downloading.ico')
else:
    icon_path = get_icon_path('q_dlp.ico')
```

### 3. 高分辨率支持
确保图标在高DPI显示器上清晰：
```python
# 启用高DPI支持
app.setAttribute(Qt.ApplicationAttribute.AA_EnableHighDpiScaling)
```

---

🎯 **现在Q_DLP拥有了完整的图标系统！**

所有窗口都使用了合适的图标，提供专业统一的视觉体验，同时支持开发和打包环境的无缝切换。